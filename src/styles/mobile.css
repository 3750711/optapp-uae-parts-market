/* Mobile-optimized utilities for forms and viewport issues */

/* Safe height utilities that work across mobile browsers */
.safe-height {
  min-height: 100vh; /* Fallback */
  min-height: 100dvh; /* Dynamic viewport height */
  min-height: 100svh; /* Small viewport height as secondary fallback */
}

.safe-screen {
  height: 100vh; /* Fallback */
  height: 100dvh; /* Dynamic viewport height */
  height: 100svh; /* Small viewport height as secondary fallback */
}

/* Performance optimizations to prevent scroll-linked effects */
@media (max-width: 768px) {
  /* Disable problematic scroll effects on mobile */
  .mobile-scroll-optimized {
    -webkit-overflow-scrolling: auto !important;
    scroll-behavior: auto !important;
    overscroll-behavior: contain;
    contain: layout style paint;
  }
  
  /* Force hardware acceleration selectively */
  .hw-accelerated {
    transform: translateZ(0);
    will-change: transform;
  }
  
  /* Remove hardware acceleration when not needed */
  .hw-accelerated.idle {
    will-change: auto;
    transform: none;
  }
}

/* Firefox-specific optimizations */
@-moz-document url-prefix() {
  @media (max-width: 768px) {
    .mobile-scroll {
      scroll-behavior: auto !important;
    }
  }
}

/* Mobile form containers that handle keyboard properly */
.mobile-form {
  max-height: calc(100dvh - 2rem);
  max-height: calc(100vh - 2rem); /* Fallback */
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* Optimize mobile forms for better performance */
@media (max-width: 768px) {
  .mobile-form {
    -webkit-overflow-scrolling: auto;
    scroll-behavior: auto;
  }
}

/* Sticky footer for mobile forms */
.sticky-footer {
  position: sticky;
  bottom: 0;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(8px);
  border-top: 1px solid hsl(var(--border));
  z-index: 10;
}

/* Prevent background scrolling when modal/form is open */
.prevent-scroll {
  overflow: hidden;
  overscroll-behavior: contain;
}

/* Mobile-optimized input focus */
.mobile-input:focus {
  /* Prevent zoom on iOS */
  font-size: 16px;
  transform: none;
}

/* Telegram WebView specific optimizations */
@media screen and (max-width: 480px) {
  /* Ensure forms are always accessible */
  .telegram-form {
    padding-bottom: env(keyboard-inset-height, 0px);
    transition: padding-bottom 0.3s ease;
  }
  
  /* Better touch targets */
  .mobile-touch-target {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Android keyboard handling */
@supports (height: 100dvh) {
  .mobile-form {
    max-height: calc(100dvh - 2rem);
  }
  
  .safe-height {
    min-height: 100dvh;
  }
  
  .safe-screen {
    height: 100dvh;
  }
}

/* Text overflow utilities for mobile */
.overflow-wrap-anywhere {
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

.mobile-text-sizing {
  font-size: 0.75rem; /* 12px */
}

@media (min-width: 640px) {
  .mobile-text-sizing {
    font-size: 0.875rem; /* 14px */
  }
}